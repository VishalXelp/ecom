{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, useEffect, useCallback } from \"react\";\n\nfunction useForm(stateSchema, validationSchema = {}, callback) {\n  const {\n    0: state,\n    1: setState\n  } = useState(stateSchema);\n  const {\n    0: disable,\n    1: setDisable\n  } = useState(true);\n  const {\n    0: isDirty,\n    1: setIsDirty\n  } = useState(false);\n  useEffect(() => {\n    setDisable(true);\n  }, []);\n  useEffect(() => {\n    if (isDirty) {\n      setDisable(validateState());\n    }\n  }, [state, isDirty]); // Used to disable submit button if there's an error in state\n  // or the required field in state has no value.\n  // Wrapped in useCallback to cached the function to avoid instensive memory leaked\n  // in every re-render in component\n\n  const validateState = useCallback(() => {\n    const hasErrorInState = Object.keys(validationSchema).some(key => {\n      const isInputFieldRequired = validationSchema[key].required; // Get state value\n\n      const stateValue = state[key].value;\n      const stateError = state[key].error;\n      return isInputFieldRequired && !stateValue || stateError;\n    });\n    return hasErrorInState;\n  }, [state, validationSchema]);\n\n  function handleOnChange(event) {\n    setIsDirty(true);\n    const name = event.target.name;\n    const value = event.target.value;\n    let error = \"\";\n\n    if (validationSchema[name].required) {\n      if (!value) {\n        error = \"This is required field.\";\n      }\n    }\n\n    if (validationSchema[name].validator !== null && typeof validationSchema[name].validator === \"object\") {\n      if (validationSchema[name].validator.regEx) {\n        if (value && !validationSchema[name].validator.regEx.test(value)) {\n          error = validationSchema[name].validator.error;\n        }\n      }\n    }\n\n    setState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      [name]: {\n        value,\n        error\n      }\n    }));\n  }\n\n  function handleOnSubmit(event) {\n    event.preventDefault(); // Making sure that validateState returns false\n    // Before calling the submit callback function\n\n    if (!validateState()) {\n      callback();\n    }\n  }\n\n  return {\n    state,\n    disable,\n    handleOnChange,\n    handleOnSubmit\n  };\n}\n\nexport default useForm;","map":{"version":3,"names":["useState","useEffect","useCallback","useForm","stateSchema","validationSchema","callback","state","setState","disable","setDisable","isDirty","setIsDirty","validateState","hasErrorInState","Object","keys","some","key","isInputFieldRequired","required","stateValue","value","stateError","error","handleOnChange","event","name","target","validator","regEx","test","prevState","handleOnSubmit","preventDefault"],"sources":["/home/xelpmoc/Desktop/pocb2b/ecommerce-poc/components/checkout/userForm.js"],"sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\r\n\r\nfunction useForm(stateSchema, validationSchema = {}, callback) {\r\n    const [state, setState] = useState(stateSchema);\r\n    const [disable, setDisable] = useState(true);\r\n    const [isDirty, setIsDirty] = useState(false);\r\n\r\n    useEffect(() => {\r\n        setDisable(true);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (isDirty) {\r\n            setDisable(validateState());\r\n        }\r\n    }, [state, isDirty]);\r\n\r\n    // Used to disable submit button if there's an error in state\r\n    // or the required field in state has no value.\r\n    // Wrapped in useCallback to cached the function to avoid instensive memory leaked\r\n    // in every re-render in component\r\n    const validateState = useCallback(() => {\r\n        const hasErrorInState = Object.keys(validationSchema).some(key => {\r\n            const isInputFieldRequired = validationSchema[key].required;\r\n            // Get state value\r\n            const stateValue = state[key].value;\r\n            const stateError = state[key].error;\r\n\r\n            return (isInputFieldRequired && !stateValue) || stateError;\r\n        });\r\n\r\n        return hasErrorInState;\r\n    }, [state, validationSchema]);\r\n\r\n    function handleOnChange(event) {\r\n        setIsDirty(true);\r\n\r\n        const name = event.target.name;\r\n        const value = event.target.value;\r\n\r\n        let error = \"\";\r\n        if (validationSchema[name].required) {\r\n            if (!value) {\r\n                error = \"This is required field.\";\r\n            }\r\n        }\r\n\r\n        if (\r\n            validationSchema[name].validator !== null &&\r\n            typeof validationSchema[name].validator === \"object\"\r\n        ) {\r\n            if (validationSchema[name].validator.regEx){\r\n                if (value && !validationSchema[name].validator.regEx.test(value)) {\r\n                    error = validationSchema[name].validator.error;\r\n                }\r\n            }\r\n        }\r\n\r\n        setState(prevState => ({\r\n            ...prevState,\r\n            [name]: { value, error }\r\n        }));\r\n    }\r\n\r\n    function handleOnSubmit(event) {\r\n        event.preventDefault();\r\n\r\n        // Making sure that validateState returns false\r\n        // Before calling the submit callback function\r\n        if (!validateState()) {\r\n            callback();\r\n        }\r\n    }\r\n\r\n    return { state, disable, handleOnChange, handleOnSubmit };\r\n}\r\n\r\nexport default useForm;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}